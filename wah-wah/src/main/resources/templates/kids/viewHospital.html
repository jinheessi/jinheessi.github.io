<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
	<meta charset="UTF-8">
	<link href="/css/bootstrap.min.css" rel="stylesheet">
	<title>Insert title here</title>
	
	</head>
	<body>

<main>
  <div class="album py-5 bg-light">
    <div class="container">
	  <h3><b th:text="${hospital_name}"></b></h3>
	  <br>
      <div class="row row-cols-3">
        <div class="col-12">
          <div class="card shadow-md">
            <div class="card-body">
              <div class="map_wrap">
			    <div id="mapWrapper" style="width:50%;height:300px;float:left">
			        <div id="map" style="width:100%;height:100%"></div> <!-- 지도를 표시할 div 입니다 -->
			    </div>
			    <div id="rvWrapper" style="width:50%;height:300px;float:left">
			        <div id="roadview" style="width:100%;height:100%"></div> <!-- 로드뷰를 표시할 div 입니다 -->
			    </div>
			  </div>
              <div>
	              <p class="card-text">
						<br><h5 th:text="|${road}&nbsp;|">(<small th:text="${old_addr}"></small>)</h5>
						<h5 th:text="${phone}"></h5>
	              </p>
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group" style="margin-left:auto; margin-right:auto;">
                  <button type="button" class="btn btn-sm btn-outline-secondary" onclick="reservation()">예약하기</button>
                  <button type="button" class="btn btn-sm btn-outline-secondary" onclick="call()">전화하기</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
      </div>
    </div>
  </div>

</main>
<div class="col-8" style="margin-left:auto; margin-right:auto;">
<h5><a href="/kids/reviewView">리뷰 보기</a></h5>
<div class="list-group">
  <a href="#" class="list-group-item list-group-item-action" aria-current="true">
    <div class="d-flex w-100 justify-content-between">
      <h5 class="mb-1">List group item heading</h5>
      <small>3 days ago</small>
    </div>
    <p class="mb-1">Some placeholder content in a paragraph.</p>
    <small>And some small print.</small>
  </a>
  </div>
</div>
<nav class="navbar bg-body-tertiary fixed-top" style="margin-left:90%;">
	  <div class="container-fluid">
	    <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
	      <span class="navbar-toggler-icon"></span>
	    </button>
	    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
	      <div class="offcanvas-header">
	        <h5 class="offcanvas-title" id="offcanvasNavbarLabel" th:text="|${hospital_name}님 환영합니다.|"></h5>
	        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
	      </div>
	      <div class="offcanvas-body">
	        <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
	          <li class="nav-item">
	            <a class="nav-link active" aria-current="page" th:href="@{/master/modifyInfo}">내 정보 수정</a>
	          </li>
	          <li class="nav-item">
	            <a class="nav-link" th:href="@{/master/manageReservation}">예약 관리</a>
	          </li>
	        </ul>
	      </div>
	    </div>
	  </div>
	</nav>

<footer class="text-muted py-5">
  <div class="container">
    <p class="float-end mb-1">
      <a href="/Pediatrics">이전으로</a>
    </p>
    <a href="/">홈으로</a>
  </div>
</footer>



<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=67f892ae27b42594c7defd720d2dcdc9&libraries=services"></script>
<script>
var mapWrapper = document.getElementById('mapWrapper'); //지도를 감싸고 있는 DIV태그

var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
    mapCenter = new kakao.maps.LatLng(${y} ,${x}), // 지도의 가운데 좌표
    mapOption = {
        center: mapCenter, // 지도의 중심좌표
        level: 3 // 지도의 확대 레벨
    };

// 지도를 표시할 div와  지도 옵션으로  지도를 생성합니다
var map = new kakao.maps.Map(mapContainer, mapOption);
map.addOverlayMapTypeId(kakao.maps.MapTypeId.ROADVIEW); //지도 위에 로드뷰 도로 올리기

var rvContainer = document.getElementById('roadview'); //로드뷰를 표시할 div
var rv = new kakao.maps.Roadview(rvContainer); //로드뷰 객체
var rvClient = new kakao.maps.RoadviewClient(); //좌표로부터 로드뷰 파노ID를 가져올 로드뷰 helper객체

toggleRoadview(mapCenter);

// 마커 이미지를 생성합니다.
var markImage = new kakao.maps.MarkerImage(
    'https://t1.daumcdn.net/localimg/localimages/07/2018/pc/roadview_minimap_wk_2018.png',
    new kakao.maps.Size(26, 46),
    {
        // 스프라이트 이미지를 사용합니다.
        // 스프라이트 이미지 전체의 크기를 지정하고
        spriteSize: new kakao.maps.Size(1666, 168),
        // 사용하고 싶은 영역의 좌상단 좌표를 입력합니다.
        // background-position으로 지정하는 값이며 부호는 반대입니다.
        spriteOrigin: new kakao.maps.Point(705, 114),
        offset: new kakao.maps.Point(13, 46)
    }
);

// 드래그가 가능한 마커를 생성합니다.
var rvMarker = new kakao.maps.Marker({
    image : markImage,
    position: mapCenter,
    draggable: true,
    map: map
});

//마커에 dragend 이벤트를 할당합니다
kakao.maps.event.addListener(rvMarker, 'dragend', function(mouseEvent) {
    var position = rvMarker.getPosition(); //현재 마커가 놓인 자리의 좌표
    toggleRoadview(position); //로드뷰를 토글합니다
});

//지도에 클릭 이벤트를 할당합니다
kakao.maps.event.addListener(map, 'click', function(mouseEvent){
    
    // 현재 클릭한 부분의 좌표를 리턴 
    var position = mouseEvent.latLng; 

    rvMarker.setPosition(position);
    toggleRoadview(position); //로드뷰를 토글합니다
});

//로드뷰 toggle함수
function toggleRoadview(position){

    //전달받은 좌표(position)에 가까운 로드뷰의 panoId를 추출하여 로드뷰를 띄웁니다
    rvClient.getNearestPanoId(position, 50, function(panoId) {
        if (panoId === null) {
            rvContainer.style.display = 'none'; //로드뷰를 넣은 컨테이너를 숨깁니다
            mapWrapper.style.width = '100%';
            map.relayout();
        } else {
            mapWrapper.style.width = '50%';
            map.relayout(); //지도를 감싸고 있는 영역이 변경됨에 따라, 지도를 재배열합니다
            rvContainer.style.display = 'block'; //로드뷰를 넣은 컨테이너를 보이게합니다
            rv.setPanoId(panoId, position); //panoId를 통한 로드뷰 실행
            rv.relayout(); //로드뷰를 감싸고 있는 영역이 변경됨에 따라, 로드뷰를 재배열합니다
        }
    });
}
</script>
    <script src="/resources/js/bootstrap.bundle.min.js"></script>

      
	</body>
</html>